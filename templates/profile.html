{% extends "layout.html" %}

{% block title %}Mi Perfil{% endblock %}

{% block content %}
<div class="w-full max-w-2xl bg-white dark:bg-[#192633] rounded-2xl border border-slate-200 dark:border-[#324d67] shadow-xl overflow-hidden mx-auto">
    
    <div class="bg-gradient-to-r from-blue-600 to-blue-800 p-8 text-center">
        <img src="{{ user.profile_pic }}" alt="Avatar" class="w-24 h-24 rounded-full border-4 border-white dark:border-[#192633] mx-auto shadow-lg mb-4 object-cover">
        <h1 class="text-2xl font-bold text-white">{{ user.username }}</h1>
        <span class="inline-block px-3 py-1 mt-2 rounded-full text-xs font-bold bg-white/20 text-white backdrop-blur-sm">
            {% if user.is_admin %}Administrador{% else %}Usuario Estándar{% endif %}
        </span>
    </div>

    <div class="p-8">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                <div class="mb-6 p-4 rounded-lg text-sm font-bold text-center border
                    {% if category == 'error' %} bg-red-500/10 text-red-400 border-red-500/20
                    {% else %} bg-green-500/10 text-green-400 border-green-500/20 {% endif %}">
                    {{ message }}
                </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <form method="POST" enctype="multipart/form-data" class="grid grid-cols-1 md:grid-cols-2 gap-6">
            
            <div class="md:col-span-2 flex flex-col gap-2 p-4 border border-dashed border-slate-300 dark:border-slate-600 rounded-lg bg-slate-50 dark:bg-[#0d141c]">
                <label class="text-xs font-bold text-slate-500 uppercase">Cambiar Foto</label>
                <input type="file" name="profile_pic" accept=".png, .jpg, .jpeg, .gif"
                    class="block w-full text-sm text-slate-500
                    file:mr-4 file:py-2 file:px-4
                    file:rounded-full file:border-0
                    file:text-sm file:font-semibold
                    file:bg-blue-500/10 file:text-blue-500
                    hover:file:bg-blue-500/20 cursor-pointer dark:text-slate-300">
                <p class="text-[10px] text-slate-400">Formatos permitidos: JPG, PNG, GIF</p>
            </div>

            <div class="flex flex-col gap-2">
                <label class="text-xs font-bold text-slate-500 uppercase">Email</label>
                <input type="email" name="email" value="{{ user.email or '' }}" placeholder="ejemplo@correo.com"
                    class="bg-slate-50 dark:bg-[#0d141c] border border-slate-200 dark:border-[#324d67] rounded-lg p-3 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary outline-none transition-all">
            </div>

            <div class="flex flex-col gap-2">
                <label class="text-xs font-bold text-slate-500 uppercase">Teléfono</label>
                <input type="tel" name="phone" value="{{ user.phone or '' }}" placeholder="+34 600 92 92 92"
                    class="bg-slate-50 dark:bg-[#0d141c] border border-slate-200 dark:border-[#324d67] rounded-lg p-3 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary outline-none transition-all">
            </div>

            <div class="flex flex-col gap-2 md:col-span-2">
                <label class="text-xs font-bold text-slate-500 uppercase">Cambiar Contraseña</label>
                <input type="password" name="password" placeholder="Deja en blanco para mantener la actual"
                    class="bg-slate-50 dark:bg-[#0d141c] border border-slate-200 dark:border-[#324d67] rounded-lg p-3 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary outline-none transition-all">
            </div>

            <div class="md:col-span-2 pt-4">
                <button type="submit" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded-lg shadow-lg shadow-blue-600/20 transition-all active:scale-95">
                    Guardar Cambios
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}